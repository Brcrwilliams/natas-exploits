When logging into this application we are greeted with the message "Note: this website is colocated with http://natas21-experimenter.natas.labs.overthewire.org".

![home page](/images/natas211.png)

Looking at the source code, we see that, like the previous challenge, we need to have an admin's session identifier.

```
function print_credentials() { /* {{{ */
    if($_SESSION and array_key_exists("admin", $_SESSION) and $_SESSION["admin"] == 1) {
    print "You are an admin. The credentials for the next level are:<br>";
    print "<pre>Username: natas22\n";
    print "Password: <censored></pre>";
    } else {
    print "You are logged in as a regular user. Login as an admin to retrieve credentials for natas22.";
    }
}
```

When we head over to http://natas21-experimenter.natas.labs.overthewire.org/ we see that this application is a "CSS Experimenter."

![CSS Experimenter](/images/natas212.png)

Looking at the source code, we see that it takes all of the request parameters and stored them as key / value pairs in the session array.
```
if(array_key_exists("submit", $_REQUEST)) {
    foreach($_REQUEST as $key => $val) {
    $_SESSION[$key] = $val;
    }
}
```
Woah, this is too easy. So all we have to do is add an admin=1 parameter and we're an admin.

![params](/images/natas213.png)

After our request goes through, it looks like it worked.

![result](/images/natas214.png)

Then, we copy down our PHPSESSID, since we know it has admin privieges now, and we got back to the original natas21 site.

We'll submit a request and intercept it in Burp, and then paste the session ID that we copied.

It worked!

![ding ding ding](/images/natas216.png)
